# defIUT

This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
You should have received a copy of the GNU General Public License along with this program. If not, see <https://www.gnu.org/licenses/>

Ce programme est un logiciel libreâ€¯; vous pouvez le redistribuer ou le modifier suivant les termes de la GNU General Public License telle que publiÃ©e par la Free Software Foundationâ€¯; soit la version 3 de la licence, soit (Ã  votre grÃ©) toute version ultÃ©rieure.
Ce programme est distribuÃ© dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIEâ€¯; sans mÃªme la garantie tacite de QUALITÃ‰ MARCHANDE ou d'ADÃ‰QUATION Ã  UN BUT PARTICULIER. Consultez la GNU General Public License pour plus de dÃ©tails.
Vous devez avoir reÃ§u une copie de la GNU General Public License en mÃªme temps que ce programmeâ€¯; si ce n'est pas le cas, consultez <http://www.gnu.org/licenses>

Environment composition:

- Docker Compose
- Nginx, PHP-FPM 7.2 and Xdebug (works on macOS)
- MySQL
- Symfony 4.2
- Node, Webpack and Vue.js

## Project structure

```
.
â”œâ”€â”€ app // Symfony app directory
â”‚Â Â  â”œâ”€â”€ assets // Folder generated by symfony/webpack-encore-bundle
â”‚Â Â  â”‚Â Â  â””â”€â”€ vue
â”‚Â Â  â”œâ”€â”€ bin
â”‚Â Â  â”œâ”€â”€ config // Symfony app config
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ packages
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dev
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ prod
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ test
â”‚Â Â  â”‚Â Â  â””â”€â”€ routes
â”‚Â Â  â”‚Â Â      â””â”€â”€ dev
â”‚Â Â  â”œâ”€â”€ public // This is where the index.php lies
â”‚Â Â  â”‚Â Â  â””â”€â”€ build // And that is responsible for building your js to index.js
â”‚Â Â  â”œâ”€â”€ src // Your Symfony app core stuff
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Controller
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Entity
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Migrations
â”‚Â Â  â”‚Â Â  â””â”€â”€ Repository
â”‚Â Â  â”œâ”€â”€ templates // Twig templates
â”‚Â Â  â”œâ”€â”€ tests
â”‚Â Â  â”œâ”€â”€ translations
â”‚Â Â  â””â”€â”€ var 
â”‚Â Â      â”œâ”€â”€ cache
â”‚Â Â      â””â”€â”€ log
â”œâ”€â”€ docker 
â”‚Â Â  â”œâ”€â”€ config // Directory with nginx/php configurations. 
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nginx
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ hosts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ xdebug
â”‚Â Â  â”‚Â Â  â””â”€â”€ php
â”‚Â Â  â””â”€â”€ php // Here lies php Dockerfile
â””â”€â”€ logs // Docker containers' logs

```

## Installation
  
1. Build and run Docker containers
   
    Make sure that 80 port is not in use.
   Execute that command in root folder
    ```bash
    docker-compose up --build -d
    ```
    
    > **Note:**  
    Docker containers can be launched with [docker-sync](http://docker-sync.io/)  
    I **highly recommend** macOS users to use that way because of these [performance tests](https://github.com/EugenMayer/docker-sync/wiki/4.-Performance)  
    My page loading time decreased from 8 seconds to 250 ms  
    To use it you need to install docker-sync on your machine (link above)  
    After you build Docker container with `docker-compose build`  
    Use `make start_dev` and `make stop_dev` to control your containers  
    >
    
    > If you don't need [docker-sync](http://docker-sync.io/) delete `docker-compose-dev.yml` `docker-sync.yml` and `Makefile` from the project root

2. Should be OK ! I hope because i lost 4 hours of my life doing it ðŸ‘

## How to run your containers

* Run your containers 
  > `docker-compose up -d` or  `make start_dev`
* Run webpack watch command `npm run watch`
  > You can also find `dev` adn `build` commands in package.json file 
* Go to http://localhost:80/  
  Welcome to your application!
  ![](https://i.imgur.com/To5ykhz.png "")

## PhpStorm config

1. Use Docker container's PHP  

   Go to `Preferences > Languages & Frameworks > PHP`  
   Click on `...` near the CLI Interpreter  
   Add new instance from Docker  
   ![](https://i.imgur.com/kk8Kvl5.png "")  
   
2. Use path mappings  

   Go to `Preferences > Languages & Frameworks > PHP > Servers`  
   Create mappings from your `./app` to `var/www/app`  
   ![](https://i.imgur.com/ljv7h4I.png "")  
   
3. Xdebug config

   Go to `Preferences > Languages & Frameworks > PHP > Debug`  
   ![](https://i.imgur.com/KT8pEcd.png "")  

4. Database configuration  

   Use 3307 for mysql connection port or change it in docker-compose files

   ![](https://i.imgur.com/1mhkvCW.png "")  
